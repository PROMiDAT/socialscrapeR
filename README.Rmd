---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# socialscrapeR

El propósito de este paquete es hacer sencillo el proceso de extracción de datos de redes sociales como facebook y twitter.

## Instalación

Puedes instalar la versión de desarrollo con la instrucción:

``` r
install.packages("devtools")
devtools::install_github("PROMiDAT/socialscrapeR")
```
Este paquete utiliza selenium para simular la interacción de un usuario con su cuenta de Facebook por lo que antes de comenzar se debe inicializar el servidor de selenium.

## Iniciar el servidor de selenium 

```{r iniciar_servidor}
library(socialscrapeR)
session <- start_server()
```

## Iniciar sesión en Facebook

```{r facebook_login}
login_facebook(x = session,
               username = keyring::key_get("facebook_email"),
               password = keyring::key_get("facebook_pass"))
```

Nota: Para evitar exponer tus credenciales en tu código se recomienda el uso de paquete [keying](https://github.com/r-lib/keyring).

## Función `get_fb_posts`

Esta función nos retorna un data.frame con la información de las últimas `n` publicaciones de una página, esta función recibe los siguiente parámetros:

  + x = una conexión con selenium creada con la función start_server en la que ya se inicio sesión en una cuenta de Facebook con la función `login_facebook`.
  + **pagename**: nombre de la página
  + **n** : cantidad mínima de publicaciones a descargar
  + **reactions** si el valor es TRUE se retorna en un data.frame información sobre las reacciones de los usuario a la publicación
  + **comments** : si el valor es TRUE se retorna en un data.frame el contenido de los comentarios de la publicación
  + **shares** :  si el valor es TRUE se retorna en un data.frame información sobre los usuarios que compartieron la publicación
  
Veamos algunos ejemplos :

## Extraer las últimas 10 publicaciones de una pagina de Facebook 

```{r}
df <- get_fb_posts(session, pagename = "crhoy.comnoticias", n = 10)
tibble::glimpse(df)
```

La función `get_fb_post` retorna los siguiente valores.

  + **page_id** : identificador único de la página
  + **post_id** : identificador único de la publicación
  + **post_text** : contenido del texto principal de la publicación
  + **n_comments** : cantidad de comentarios
  + **n_shares** : cantidad de compartidos
  + **date_time** : hora y fecha en la que se realizó la publicación
  
  
## Extraer las últimas 10 publicaciones de una pagina de Facebook e información sobre las reacciones de la publicación.

```{r}
df <- get_fb_posts(session, pagename = "crhoy.comnoticias", n = 10, reactions = T)
tibble::glimpse(df)
tibble::glimpse(df$reactions_by_user[[1]])
```

La función `get_fb_post` retorna los siguiente valores.

  + **page_id** : identificador único de la página
  + **post_id** : identificador único de la publicación
  + **post_text** : contenido del texto principal de la publicación
  + **n_comments** : cantidad de comentarios
  + **n_shares** : cantidad de compartidos
  + **like** : cantidad de "me gusta"
  + **love** : cantidad de "me encanta"
  + **wow** : cantidad de "me sorprende"
  + **haha** : cantidad de "me da risa"
  + **sad** : cantidad de "me entristece"
  + **angry** : cantidad de "me enoja"
  + **reactions_by_user** : 
    + **full_name** : nombre real del usuario
    + **username** : nombre de la cuenta del usuario
    + **type_reaction** : reacción hecha por el usuario
  + **date_time** : hora y fecha en la que se realizó la publicación


## Extraer las últimas 10 publicaciones de una pagina de Facebook, información sobre las reacciones y comentarios de la publicación.

```{r}
df <- get_fb_posts(session, pagename = "crhoy.comnoticias", n = 10, reactions = T, commets = T)
tibble::glimpse(df)
```

La función `get_fb_post` retorna los siguiente valores.

  + **page_id** : identificador único de la página
  + **post_id** : identificador único de la publicación
  + **post_text** : contenido del texto principal de la publicación
  + **n_comments** : cantidad de comentarios
  + **n_shares** : cantidad de compartidos
  + **like** : cantidad de "me gusta"
  + **love** : cantidad de "me encanta"
  + **wow** : cantidad de "me sorprende"
  + **haha** : cantidad de "me da risa"
  + **sad** : cantidad de "me entristece"
  + **angry** : cantidad de "me enoja"
  + **reactions_by_user** : 
    + **full_name** : nombre del usuario
    + **username** : nombre de la cuenta del usuario
    + **type_reaction** : reacción hecha por el usuario
  + **comments** : 
    + **full_name** : nombre del usuario
    + **user_name** : nombre de la cuenta del usuario
    + **text** : texto del comentario
  + **date_time** : hora y fecha en la que se realizó la publicación

## Extraer las últimas 10 publicaciones de una pagina de Facebook, información sobre las reacciones, comentarios de la publicación y los usuario que compartieron la aplicación.

```{r}
df <- get_fb_posts(session, pagename = "crhoy.comnoticias", n = 10, reactions = T, commets = T, shares = T)
tibble::glimpse(df)
```

La función `get_fb_post` retorna los siguiente valores.

  + **page_id** : identificador único de la página
  + **post_id** : identificador único de la publicación
  + **post_text** : contenido del texto principal de la publicación
  + **n_comments** : cantidad de comentarios
  + **n_shares** : cantidad de compartidos
  + **like** : cantidad de "me gusta"
  + **love** : cantidad de "me encanta"
  + **wow** : cantidad de "me sorprende"
  + **haha** : cantidad de "me da risa"
  + **sad** : cantidad de "me entristece"
  + **angry** : cantidad de "me enoja"
  + **reactions_by_user** : 
    + **full_name** : nombre del usuario
    + **username** : nombre de la cuenta del usuario
    + **type_reaction** : reacción hecha por el usuario
  + **comments** : 
    + **full_name** : nombre del usuario
    + **user_name** : nombre de la cuenta del usuario
    + **text** : texto del comentario
  + **shares** :
    + **ful_name** : nombre del usuario
    + **user_name** : nombre de la cuenta de usuario
  + **date_time** : hora y fecha en la que se realizó la publicación


### Cerrar el servidor 

```{r}
stop_server(session)
```

  
